# region First Line
zero_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 1, 0, 0, 1],
}
first_rule = {
    ('0', 'b', 'b'): ['0', 'b', 'b', 1, 0, 0, 1],
    ('1', 'b', 'b'): ['1', 'b', 'b', 1, 0, 0, 1],
    ('2', 'b', 'b'): ['2', 'b', 'b', 1, 0, 0, 1],
    ('3', 'b', 'b'): ['3', 'b', 'b', 1, 0, 0, 1],
    ('4', 'b', 'b'): ['4', 'b', 'b', 1, 0, 0, 1],
    ('5', 'b', 'b'): ['5', 'b', 'b', 1, 0, 0, 1],
    ('6', 'b', 'b'): ['6', 'b', 'b', 1, 0, 0, 1],
    ('7', 'b', 'b'): ['7', 'b', 'b', 1, 0, 0, 1],
    ('8', 'b', 'b'): ['8', 'b', 'b', 1, 0, 0, 1],
    ('9', 'b', 'b'): ['9', 'b', 'b', 1, 0, 0, 1],
    ('b', 'b', 'b'): ['b', 'b', 'b', -1, 0, 0, 2]
}
second_rule = {
    ('9', 'b', 'b'): ['8', 'b', '1', 0, 0, 1, 2],
    ('8', 'b', 'b'): ['7', 'b', '1', 0, 0, 1, 2],
    ('7', 'b', 'b'): ['6', 'b', '1', 0, 0, 1, 2],
    ('6', 'b', 'b'): ['5', 'b', '1', 0, 0, 1, 2],
    ('5', 'b', 'b'): ['4', 'b', '1', 0, 0, 1, 2],
    ('4', 'b', 'b'): ['3', 'b', '1', 0, 0, 1, 2],
    ('3', 'b', 'b'): ['2', 'b', '1', 0, 0, 1, 2],
    ('2', 'b', 'b'): ['1', 'b', '1', 0, 0, 1, 2],
    ('1', 'b', 'b'): ['0', 'b', '1', 0, 0, 1, 2],
    ('0', 'b', 'b'): ['0', 'b', 'b', -1, 0, 0, 3]
}
third_rule = {
    ('0', 'b', 'b'): ['0', 'b', 'b', -1, 0, 0, 3],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 1, 1, 5],
    ('9', 'b', 'b'): ['8', 'b', '1', 1, 0, 1, 4],
    ('8', 'b', 'b'): ['7', 'b', '1', 1, 0, 1, 4],
    ('7', 'b', 'b'): ['6', 'b', '1', 1, 0, 1, 4],
    ('6', 'b', 'b'): ['5', 'b', '1', 1, 0, 1, 4],
    ('5', 'b', 'b'): ['4', 'b', '1', 1, 0, 1, 4],
    ('4', 'b', 'b'): ['3', 'b', '1', 1, 0, 1, 4],
    ('3', 'b', 'b'): ['2', 'b', '1', 1, 0, 1, 4],
    ('2', 'b', 'b'): ['1', 'b', '1', 1, 0, 1, 4],
    ('1', 'b', 'b'): ['0', 'b', '1', 1, 0, 1, 4]
}
fourth_rule = {
    ('0', 'b', 'b'): ['9', 'b', 'b', 1, 0, 0, 4],
    ('b', 'b', 'b'): ['b', 'b', 'b', -1, 0, 0, 2]
}
#  endregion First Line
# region Second Line
fifth_rule = {
    ('b', '0', 'b'): ['b', '0', 'b', 0, 1, 0, 5],
    ('b', '1', 'b'): ['b', '1', 'b', 0, 1, 0, 5],
    ('b', '2', 'b'): ['b', '2', 'b', 0, 1, 0, 5],
    ('b', '3', 'b'): ['b', '3', 'b', 0, 1, 0, 5],
    ('b', '4', 'b'): ['b', '4', 'b', 0, 1, 0, 5],
    ('b', '5', 'b'): ['b', '5', 'b', 0, 1, 0, 5],
    ('b', '6', 'b'): ['b', '6', 'b', 0, 1, 0, 5],
    ('b', '7', 'b'): ['b', '7', 'b', 0, 1, 0, 5],
    ('b', '8', 'b'): ['b', '8', 'b', 0, 1, 0, 5],
    ('b', '9', 'b'): ['b', '9', 'b', 0, 1, 0, 5],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, -1, 0, 6]
}
sixth_rule = {
    ('b', '9', 'b'): ['b', '8', '1', 0, 0, 1, 6],
    ('b', '8', 'b'): ['b', '7', '1', 0, 0, 1, 6],
    ('b', '7', 'b'): ['b', '6', '1', 0, 0, 1, 6],
    ('b', '6', 'b'): ['b', '5', '1', 0, 0, 1, 6],
    ('b', '5', 'b'): ['b', '4', '1', 0, 0, 1, 6],
    ('b', '4', 'b'): ['b', '3', '1', 0, 0, 1, 6],
    ('b', '3', 'b'): ['b', '2', '1', 0, 0, 1, 6],
    ('b', '2', 'b'): ['b', '1', '1', 0, 0, 1, 6],
    ('b', '1', 'b'): ['b', '0', '1', 0, 0, 1, 6],
    ('b', '0', 'b'): ['b', '0', 'b', 0, -1, 0, 7]
}
seventh_rule = {
    ('b', '0', 'b'): ['b', '0', 'b', 0, -1, 0, 7],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 0, 9],
    ('b', '9', 'b'): ['b', '8', '1', 0, 1, 1, 8],
    ('b', '8', 'b'): ['b', '7', '1', 0, 1, 1, 8],
    ('b', '7', 'b'): ['b', '6', '1', 0, 1, 1, 8],
    ('b', '6', 'b'): ['b', '5', '1', 0, 1, 1, 8],
    ('b', '5', 'b'): ['b', '4', '1', 0, 1, 1, 8],
    ('b', '4', 'b'): ['b', '3', '1', 0, 1, 1, 8],
    ('b', '3', 'b'): ['b', '2', '1', 0, 1, 1, 8],
    ('b', '2', 'b'): ['b', '1', '1', 0, 1, 1, 8],
    ('b', '1', 'b'): ['b', '0', '1', 0, 1, 1, 8]
}
eighth_rule = {
    ('b', '0', 'b'): ['b', '9', 'b', 0, 1, 0, 8],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, -1, 0, 5]
}
# endregion Second Line
# region Subtraction
ninth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 10]
}
tenth_rule = {
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 10],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 11]
}
eleventh_rule = {
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 11],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 12]
}
twelfth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 12],
    ('b', 'b', '1'): ['b', 'b', 'b', 0, 0, 1, 13]
}
thirteenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 14],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, 1, 13]
}
fourteenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 15],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, 1, 14]
}
fifteenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 0, 20],
    ('b', 'b', '1'): ['b', 'b', 'b', 0, 0, -1, 16]
}
sixteenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 0, 20],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 17]
}
seventeenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 18],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 17]
}
eighteenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 0, 20],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 19]
}
nineteenth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 12],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 19]
}
# endregion Subtraction
# region Parsing
twentieth_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 21]
}
twenty_first_rule = {
    ('b', 'b', 'b'): ['b', 'b', '0', 0, 0, -1, 22]
}
twenty_second_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 23]
}
twenty_third_rule = {
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 23],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 24]
}
twenty_fourth_rule = {
    ('b', 'b', '1'): ['b', 'b', 'b', 0, 0, 1, 25]
}
twenty_fifth_rule = {
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, 1, 25],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 26]
}
twenty_sixth_rule = {
    ('b', 'b', '0'): ['b', 'b', '0', 0, 0, 1, 26],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, 1, 26],
    ('b', 'b', '2'): ['b', 'b', '2', 0, 0, 1, 26],
    ('b', 'b', '3'): ['b', 'b', '3', 0, 0, 1, 26],
    ('b', 'b', '4'): ['b', 'b', '4', 0, 0, 1, 26],
    ('b', 'b', '5'): ['b', 'b', '5', 0, 0, 1, 26],
    ('b', 'b', '6'): ['b', 'b', '6', 0, 0, 1, 26],
    ('b', 'b', '7'): ['b', 'b', '7', 0, 0, 1, 26],
    ('b', 'b', '8'): ['b', 'b', '8', 0, 0, 1, 26],
    ('b', 'b', '9'): ['b', 'b', '9', 0, 0, 1, 26],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 27]
}
twenty_seventh_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 28],
    ('b', 'b', '0'): ['b', 'b', '1', 0, 0, 0, 30],
    ('b', 'b', '1'): ['b', 'b', '2', 0, 0, 0, 30],
    ('b', 'b', '2'): ['b', 'b', '3', 0, 0, 0, 30],
    ('b', 'b', '3'): ['b', 'b', '4', 0, 0, 0, 30],
    ('b', 'b', '4'): ['b', 'b', '5', 0, 0, 0, 30],
    ('b', 'b', '5'): ['b', 'b', '6', 0, 0, 0, 30],
    ('b', 'b', '6'): ['b', 'b', '7', 0, 0, 0, 30],
    ('b', 'b', '7'): ['b', 'b', '8', 0, 0, 0, 30],
    ('b', 'b', '8'): ['b', 'b', '9', 0, 0, 0, 30],
    ('b', 'b', '9'): ['b', 'b', '0', 0, 0, -1, 27]
}
twenty_eighth_rule = {
    ('b', 'b', '0'): ['b', 'b', '1', 0, 0, 1, 29],
}
twenty_ninth_rule = {
    ('b', 'b', '0'): ['b', 'b', '0', 0, 0, 1, 29],
    ('b', 'b', 'b'): ['b', 'b', '0', 0, 0, 0, 30]
}
thirtieth_rule = {
    ('b', 'b', '0'): ['b', 'b', '0', 0, 0, -1, 30],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 30],
    ('b', 'b', '2'): ['b', 'b', '2', 0, 0, -1, 30],
    ('b', 'b', '3'): ['b', 'b', '3', 0, 0, -1, 30],
    ('b', 'b', '4'): ['b', 'b', '4', 0, 0, -1, 30],
    ('b', 'b', '5'): ['b', 'b', '5', 0, 0, -1, 30],
    ('b', 'b', '6'): ['b', 'b', '6', 0, 0, -1, 30],
    ('b', 'b', '7'): ['b', 'b', '7', 0, 0, -1, 30],
    ('b', 'b', '8'): ['b', 'b', '8', 0, 0, -1, 30],
    ('b', 'b', '9'): ['b', 'b', '9', 0, 0, -1, 30],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, -1, 31]
}
thirty_first_rule = {
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 0, -1],
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 32],
}
thirty_second_rule = {
    ('b', 'b', '1'): ['b', 'b', '1', 0, 0, -1, 32],
    ('b', 'b', 'b'): ['b', 'b', 'b', 0, 0, 1, 24]
}
# endregion Parsing
rules = {
    0: zero_rule,
    1: first_rule,
    2: second_rule,
    3: third_rule,
    4: fourth_rule,
    5: fifth_rule,
    6: sixth_rule,
    7: seventh_rule,
    8: eighth_rule,
    9: ninth_rule,
    10: tenth_rule,
    11: eleventh_rule,
    12: twelfth_rule,
    13: thirteenth_rule,
    14: fourteenth_rule,
    15: fifteenth_rule,
    16: sixteenth_rule,
    17: seventeenth_rule,
    18: eighteenth_rule,
    19: nineteenth_rule,
    20: twentieth_rule,
    21: twenty_first_rule,
    22: twenty_second_rule,
    23: twenty_third_rule,
    24: twenty_fourth_rule,
    25: twenty_fifth_rule,
    26: twenty_sixth_rule,
    27: twenty_seventh_rule,
    28: twenty_eighth_rule,
    29: twenty_ninth_rule,
    30: thirtieth_rule,
    31: thirty_first_rule,
    32: thirty_second_rule
}


def main():
    first_line = ['b', '1', '5', 'b']
    second_line = ['b', '9', 'b']
    third_line = ['b']
    first_pos = 0
    second_pos = 0
    third_pos = 0
    rule = 0
    while rule != -1:
        f_symb, s_symb, t_symb, f_pos, s_pos, t_pos, r = \
            rules[rule][(first_line[first_pos], second_line[second_pos], third_line[third_pos])]
        first_line[first_pos] = f_symb
        second_line[second_pos] = s_symb
        third_line[third_pos] = t_symb
        first_pos += f_pos
        second_pos += s_pos
        third_pos += t_pos
        rule = r
        if first_pos == len(first_line):
            first_line.append('b')
        if second_pos == len(second_line):
            second_line.append('b')
        if third_pos == len(third_line):
            third_line.append('b')
        if third_pos < 0:
            third_line.insert(0, 'b')
            third_pos = 0


    result = ''
    for symbol in third_line:
        result += symbol
    result = result.replace('b', '')
    print(result)


main()
